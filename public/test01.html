<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matrix Swipe with 3x3 Viewport</title>
  <style>
    body,
    html {
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100%;
      width: 100%;
      font-family: Arial, sans-serif;
    }

    #wrapper {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    #container {
      position: absolute;
      top: 0;
      left: 0;
      width: 300%;
      height: 300%;
      display: flex;
      flex-wrap: wrap;
      transition: transform 0.3s ease;
    }

    .cell {
      flex: 0 0 33.33%;
      height: 33.33%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
  </style>
</head>

<body>
  <div id="wrapper">
    <div id="container"></div>
  </div>

  <script>
    const matrixSize = 100;
    const matrix = Array.from({ length: matrixSize }, (_, i) =>
      Array.from({ length: matrixSize }, (_, j) => `Cell ${i + 1},${j + 1}`)
    );

    let currentRow = 1;
    let currentCol = 1;
    let touchstartX = 0;
    let touchstartY = 0;
    let isSwiping = false;

    const container = document.getElementById('container');

    const colors = [
      '#FFB6C1', '#FFD700', '#90EE90', '#ADD8E6', '#FF69B4',
      '#8A2BE2', '#FF7F50', '#5F9EA0', '#7FFF00'
    ];

    function renderMatrix() {
      container.innerHTML = '';

      for (let i = -1; i <= 1; i++) {
        for (let j = -1; j <= 1; j++) {
          const row = currentRow + i;
          const col = currentCol + j;
          const cell = document.createElement('div');
          cell.classList.add('cell');

          if (row >= 0 && row < matrixSize && col >= 0 && col < matrixSize) {
            cell.textContent = matrix[row][col];
            cell.style.backgroundColor = colors[(row * matrixSize + col) % colors.length];
          } else {
            cell.textContent = 'Out of bounds';
            cell.style.backgroundColor = '#D3D3D3';
          }

          container.appendChild(cell);
        }
      }

      container.style.transform = `translate(-${100}vw, -${100}vh)`;
    }

    container.addEventListener('touchstart', (e) => {
      touchstartX = e.changedTouches[0].screenX;
      touchstartY = e.changedTouches[0].screenY;
      isSwiping = true;
    });

    container.addEventListener('touchmove', (e) => {
      if (!isSwiping) return;
      const touch = e.changedTouches[0];
      const diffX = touch.screenX - touchstartX;
      const diffY = touch.screenY - touchstartY;

      container.style.transition = '';
      container.style.transform = `translate(calc(-${100}vw + ${diffX}px), calc(-${100}vh + ${diffY}px))`;
    });

    container.addEventListener('touchend', (e) => {
      if (!isSwiping) return;
      isSwiping = false;

      const touchendX = e.changedTouches[0].screenX;
      const touchendY = e.changedTouches[0].screenY;
      const diffX = touchendX - touchstartX;
      const diffY = touchendY - touchstartY;

      if (Math.abs(diffX) > Math.abs(diffY)) {
        if (Math.abs(diffX) > window.innerWidth / 6) {
          if (diffX > 0 && currentCol > 0) {
            currentCol--;
          } else if (diffX < 0 && currentCol < matrixSize - 1) {
            currentCol++;
          }
        }
      } else {
        if (Math.abs(diffY) > window.innerHeight / 6) {
          if (diffY > 0 && currentRow > 0) {
            currentRow--;
          } else if (diffY < 0 && currentRow < matrixSize - 1) {
            currentRow++;
          }
        }
      }

      renderMatrix();
      container.style.transition = 'transform 0.3s ease';
    });

    // 初始化显示
    renderMatrix();
  </script>
</body>

</html>